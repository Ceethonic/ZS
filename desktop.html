<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Zgłoś Spam (Desktop)</title>
  <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
  <style>
    body { font-family: 'Segoe UI', Tahoma, sans-serif; padding: 20px; background: #f4f6f8; color: #333; text-align: center; }
    button { background: #0078d4; color: white; border: none; padding: 12px 24px; font-size: 16px; border-radius: 4px; cursor: pointer; }
    button:hover { background: #005a9e; }
    .message { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>
  <h1>Zgłoś Spam (Desktop)</h1>
  <p>Przekaż wiadomość jako załącznik do zespołu bezpieczeństwa.</p>
  <button id="reportBtn">Przekaż wiadomość jako EML</button>
  <div class="message" id="resultMessage"></div>

  <script>
    function showMessage(msg, success = true) {
      const div = document.getElementById("resultMessage");
      div.textContent = msg;
      div.style.color = success ? "#107c10" : "#d83b01";
    }

    Office.onReady(() => {
      document.getElementById("reportBtn").addEventListener("click", () => {
        const item = Office.context.mailbox.item;
        if (!item) return showMessage("Nie można pobrać wiadomości.", false);

        Office.context.mailbox.item.forwardAsync({
          toRecipients: ["tomaszciszewski01@gmail.com"],
          subject: "SPAM: " + (item.subject || "(brak tematu)"),
          htmlBody: "<p>Proszę o analizę tej wiadomości jako potencjalnego spamu.</p>"
        }, function (result) {
          if (result.status === Office.AsyncResultStatus.Succeeded) {
            showMessage("Wiadomość została przekazana.");
          } else {
            showMessage("Błąd: " + result.error.message, false);
          }
        });
      });
    });
  </script>
</body>
</html>
